# Workflow'un adı
name: Gunluk BIST Verisi Cek

# 1. TETİKLEYİCİ
on:
  schedule:
    - cron: '0 17 * * *'
  workflow_dispatch:

# 2. İŞLER
jobs:
  build-and-run:
    runs-on: ubuntu-latest # Hangi sunucuda çalışacak

    # EKLENEN YENİ İZİN AYARI
    permissions:
      contents: write # Bot'a yazma izni veriyoruz

    # 3. ADIMLAR
    steps:
      # Adım 1: Kodu sunucuya indir
      - name: Kodu Checkout Yap
        uses: actions/checkout@v4

      # Adım 2: Python'u kur
      - name: Python 3.10 Kur
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # Adım 3: Gerekli kütüphaneleri kur
      - name: Kütüphaneleri Yukle
        run: pip install -r requirements.txt

      # Adım 4: Bizim asıl script'imizi çalıştır
      - name: Python Script'ini Calistir
        run: python main.py

      # Adım 5: Değişiklikleri Repoya Geri Commit'le
      - name: Degisiklikleri Commit'le
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_user_email: "actions@github.com"
          commit_user_name: "GitHub Actions Bot"
          commit_message: "Günlük BIST verileri eklendi (Otomatik)"
          file_pattern: "gunluk_veriler.csv"